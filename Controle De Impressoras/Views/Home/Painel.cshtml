@model List<Controle_De_Impressoras.Models.PrintersModel>
@{
    ViewBag.Title = "Controle De Impressoras";
}
<style>
    @@media screen and (max-width: 768px) {
        body {
            background: pink;
        }
    }

    body {
        font-family: Arial, sans-serif;
        margin: 0 !important;
        padding: 0 !important;
        box-sizing: border-box;
    }

    .custom-page {
        display: grid;
        grid-template-columns: 12fr 1fr;
        gap: 2rem;
    }

    .gridContainer {
        display: grid;
        grid-template-columns: repeat(5, 1fr); /* Mantém 5 colunas como padrão */
        gap: 1rem;
        transition: grid-template-columns 0.3s ease; /* Suaviza a transição */
    }

    .gridContainer.six-columns {
        grid-template-columns: repeat(6, 1fr); /* Configura 6 colunas */
    }
    
    .gridContainer.seven-columns {
        grid-template-columns: repeat(7, 1fr); /* Configura 7 colunas */
    }


    .containerImpressora {
        background-color: #f9f9f9;
        border-radius: 1rem;
        box-shadow: rgba(0, 0, 0, 0.1) 0px 4px 12px;
        padding: 0.5rem 1rem;
        border: 1px solid #000;
        max-height: calc(100vh / 3);
    }

    .filtrosImpressoras {
        padding: 1rem 0;
        background: #ffffff;
        color: white;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 1rem;
    }

    .container body-content {
        margin: 0 !important;
        padding: 0 !important;
    }

    .gridContainer1 {
        display: grid;
        grid-template-columns: 4fr 8fr;
        gap: 1rem;
    }

    .gridContainer2 {
        display: grid;
        grid-template-columns: 10fr 2fr;
        gap: .5rem;
    }

    .gridContainer3 {
        display: grid;
        grid-template-columns: 13fr 1fr;
        gap: .5rem;
        margin-top: 1rem;
    }

    .feedback {
        width: 20px;
    }

    .feedback-nav {
        width: 2rem;
    }

    .feedback-p {
        font-size: 0.8rem;
        color: black;
    }

    .impressora {
        width: 100%;
    }

    .container-capacidade {
        display: flex;
        gap: 5px;
        margin-bottom: 10px;
        align-items: center; /* Alinha verticalmente */
        justify-content: center; /* Alinha horizontalmente */
    }

    .container-capacidade-modal {
        display: flex;
        gap: 5px;
        margin-bottom: 10px;
    }

    .ink-level {
        border: solid 1.5px black;
        width: 1.5vw; /* Largura proporcional baseada em vw */
        height: 5vh; /* Altura proporcional baseada em vh */
        background-color: #F6F7F8;
        position: relative;
        border-radius: 4px;
    }


    .ink-fill {
        position: absolute;
        bottom: 0;
        width: 100%;
        border-radius: 4px;
    }

    /* Novo estilo para o formato horizontal */
    .ink-level-horizontal {
        border: solid 1.5px black;
        height: 1.5rem; /* A altura foi reduzida para dar mais ênfase à largura */
        width: 5rem; /* Torna o mostrador mais largo */
        background-color: #F6F7F8;
        position: relative;
        border-radius: 4px;
        text-align: center;
    }

    .ink-fill-horizontal {
        position: absolute;
        left: 0;
        top: 0;
        height: 100%;
        border-radius: 4px;
    }


    .btn-plus {
        width: 2vw;
        height: 2vw;
        background-color: #45ADFF;
        color: white;
        border: none;
        border-radius: 50%;
        font-size: 3.1vh;
        display: flex;
        justify-content: center;
        align-items: center;
        cursor: pointer;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        transition: background-color 0.3s ease;
        margin-left: auto;
    }

        /* Efeito ao passar o mouse sobre o botão */
        .btn-plus:hover {
            background-color: #0056b3; /* Azul mais escuro */
        }

    /* Estilo para o ícone de mais */
    .icon {
        font-weight: bold;
    }

    .modal-content {
        padding: 1rem;
        border-radius: 8px;
    }

    /* Icone e botão fechar */
    .modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .modal-icon {
        width: 24px;
        height: 24px;
    }

    /* Grid principal */
    .modal-grid {
        display: grid;
        grid-template-areas:
            "image capacity info"
            "impressions maintenance maintenance";
        grid-template-columns: 1fr 1fr 1fr;
        gap: 1rem;
    }

    /* Área de imagem */
    .modal-img {
        grid-area: image;
    }

    .printer-image {
        width: 100%;
        border-radius: 8px;
    }

    /* Capacidade de cores */
    .modal-capacity {
        grid-area: capacity;
    }

    .color-container {
        display: flex;
        gap: 8px;
    }

    .color-item {
        width: 24px;
        height: 48px;
        border-radius: 4px;
    }

        .color-item.black {
            background-color: black;
        }

        .color-item.cyan {
            background-color: cyan;
        }

        .color-item.yellow {
            background-color: yellow;
        }

        .color-item.magenta {
            background-color: magenta;
        }

    .color-labels {
        display: flex;
        gap: 8px;
        justify-content: space-between;
    }

    /* Informações principais */
    .modal-info {
        grid-area: info;
    }

        .modal-info h6, .modal-info p {
            margin: 0;
        }

    /* Impressões totais */
    .modal-impressions {
        grid-area: impressions;
        text-align: center;
    }

    /* Manutenção */
    .modal-maintenance {
        grid-area: maintenance;
    }

    .maintenance-container {
        display: flex;
        gap: 8px;
        margin-top: 8px;
    }

    .maintenance-item {
        width: 24px;
        height: 48px;
        background-color: gray;
        border-radius: 4px;
    }

    .maintenance-labels {
        display: flex;
        gap: 8px;
        justify-content: space-between;
    }

    .gridContainer2 .info {
        width: 100%; /* A largura do pai precisa ser garantida */
        padding: 0; /* Certifique-se de que não há margens internas inesperadas */
        margin: 0; /* Garantir que não haja margens externas que possam interferir */
    }


    .info p {
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        width: calc(100vw / 10); /* Usa 1/12 da largura da tela */
        display: block;
    }

    .navbar-hidden {
        display: none;
    }

    p {
        margin-top: 0;
        margin-bottom: 0.5rem;
    }

    .ink-level-modal {
        border: solid 1.5px black;
        width: 1.5rem;
        height: 3rem;
        background-color: #F6F7F8;
        position: relative;
        border-radius: 4px;
    }

    .ink-fill-modal {
        position: absolute;
        bottom: 0;
        width: 100%;
        border-radius: 4px;
    }

    .infoTonner {
        font-weight: bold;
        font-size: 1.2vh;
        text-align: center;
    }

    .nomeDispositivo {
        font-size: 14px;
        font-weight: bold;
    }

    .numeroImpressoras {
        font-size: 1rem;
    }

    .numeroImpressoras {
        display: none;
    }

    .containerNumeroImpressoras {
        box-shadow: rgba(240, 46, 170, 0.4) 5px 5px, rgba(240, 46, 170, 0.3) 10px 10px, rgba(240, 46, 170, 0.2) 15px 15px, rgba(240, 46, 170, 0.1) 20px 20px, rgba(240, 46, 170, 0.05) 25px 25px;
        border-radius: 1rem;
        border: 2px solid rgba(240, 46, 170, 0.4);
        margin: 1rem 0;
    }    

    /* Estilos para a animação de transição */
    .transition-info {
        transition: all 0.3s ease-out;
        overflow: hidden;
        opacity: 0;
        height: 0;
    }

        .transition-info.show {
            opacity: 1;
            height: auto;
        }


    @@media (max-height: 800px) {
        .numeroImpressoras {
            display: block;
        }

        .containerNumeroImpressoras {
            display: none;
        }
    }

    @@media (min-width: 3800px) {
        .ink-level {
            border: solid 1.5px black;
            width: .75vw; /* Largura proporcional baseada em vw */
            height: 3vh; /* Altura proporcional baseada em vh */
            background-color: #F6F7F8;
            position: relative;
            border-radius: 4px;
        }


        .ink-fill {
            position: absolute;
            bottom: 0;
            width: 100%;
            border-radius: 4px;
        }

        .info p {
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            width: calc(100vw / 12); /* Usa 1/12 da largura da tela */
            display: block;
        }

        .btn-plus {
            width: 1.5vw;
            height: 1.5vw;
            background-color: #45ADFF;
            color: white;
            border: none;
            border-radius: 50%;
            font-size: 2vh;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: background-color 0.3s ease;
            margin-left: auto;
        }

            /* Efeito ao passar o mouse sobre o botão */
            .btn-plus:hover {
                background-color: #0056b3; /* Azul mais escuro */
            }

        .infoTonner {
            font-weight: bold;
            font-size: 1rem;
            text-align: center;
        }

        p {
            margin: 1rem 0;
        }

        .nomeDispositivo {
            font-size: 1.1rem;
            font-weight: bold;
        }

        .feedback {
            width: 40px;
        }
    }


</style>


<main class="custom-page">
    <section class="gridContainer">
        @foreach (var impressoras in Model)
        {
            <div class="containerImpressora">
                <div class="gridContainer1">


                    <div style="display: flex; justify-content: center; align-items: center;">
                        <img src="~/Imagens/Impressoras/@(impressoras.DeviceManufacturer + ".png")" class="impressora" alt="impressora">
                    </div>
                    <div class="container-capacidade" style="padding-top: 30px">
                        @if (impressoras.Tipo == "MONO")
                        {
                            <div>
                                <div class="ink-level">
                                    <div class="ink-fill" style="height: @String.Concat(impressoras.PorcentagemBlack, '%'); background-color: black;"></div>
                                </div>
                                <p class="infoTonner">@impressoras.PorcentagemBlack%</p>
                            </div>
                            <div>
                                <div class="ink-level">
                                    <div class="ink-fill" style="height: @String.Concat(impressoras.PorcentagemUnidadeImagem, '%'); background-color: gray;"></div>
                                </div>
                                <p class="infoTonner">@impressoras.PorcentagemUnidadeImagem%</p>
                            </div>
                        }
                        @if (impressoras.Tipo == "COLOR")
                        {
                            <div>
                                <div class="ink-level">
                                    <div class="ink-fill" style="height: @String.Concat(impressoras.PorcentagemBlack, '%'); background-color: black;"></div>
                                </div>
                                <p class="infoTonner">@impressoras.PorcentagemBlack%</p>
                            </div>
                            <div>
                                <div class="ink-level">
                                    <div class="ink-fill" style="height: @String.Concat(impressoras.PorcentagemCyan, '%'); background: linear-gradient(to top, #8AFDFF, #5AFDFF);"></div>
                                </div>
                                <p class="infoTonner">@impressoras.PorcentagemCyan%</p>
                            </div>
                            <div>
                                <div class="ink-level">
                                    <div class="ink-fill" style="height: @String.Concat(impressoras.PorcentagemYellow, '%'); background: linear-gradient(to top, #F6FF98, #F2FF66);"></div>
                                </div>
                                <p class="infoTonner">@impressoras.PorcentagemYellow%</p>
                            </div>
                            <div>
                                <div class="ink-level">
                                    <div class="ink-fill" style="height: @String.Concat(impressoras.PorcentagemMagenta, '%'); background: linear-gradient(to top, #FF8AF8, #FF5CF5);"></div>
                                </div>
                                <p class="infoTonner">@impressoras.PorcentagemMagenta%</p>
                            </div>

                        }
                    </div>
                </div>

                <div class="gridContainer2">
                    <div class="info">
                        <p class="nomeDispositivo">Dispositivo:</p>
                        <p>
                            @impressoras.Patrimonio, <em>@impressoras.PrinterModel</em>
                        </p>
                    </div>
                    <button class="btn-plus" onclick="openModal('@impressoras.PrinterModel', '@impressoras.Patrimonio', '@impressoras.DeviceModel', '@impressoras.QuantidadeImpressaoTotal', '@impressoras.PorcentagemBlack', '@impressoras.PorcentagemCyan', '@impressoras.PorcentagemYellow', '@impressoras.PorcentagemMagenta', @impressoras.PorcentagemFusor, @impressoras.PorcentagemBelt, @impressoras.PorcentagemKitManutencao, '@impressoras.Secretaria', '@impressoras.Depto', '@impressoras.PorcentagemUnidadeImagem', '@impressoras.Tipo', '@impressoras.SerialTonnerPreto', '@impressoras.DeviceManufacturer')">
                        <span class="icon">+</span>
                    </button>
                </div>


                <div class="gridContainer3">
                    <p style="margin-top: -20px; font-style: italic; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; width: auto; ">@impressoras.AbrSecretaria - @impressoras.Depto</p>
                    <img src="@(
                        impressoras.PorcentagemBlack >= 60 ? Url.Content("~/Imagens/Icon.svg") :
                        impressoras.PorcentagemBlack >= 20 ? Url.Content("~/Imagens/IconYellow.svg") :
                        impressoras.PorcentagemBlack >= 11 ? Url.Content("~/Imagens/IconOrange.svg") :
                        impressoras.PorcentagemBlack >= 1 ? Url.Content("~/Imagens/IconRed.svg") :
                        Url.Content("~/Imagens/IconBlack.svg")
                    )" class="feedback" alt="feedback">
                </div>
            </div>
        }
    </section>

    <div class="modal fade" id="impressoraModal" tabindex="-1" aria-labelledby="impressoraModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <img src="~/Imagens/Icon.svg" id="icon" class="modal-icon" alt="icon">
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body modal-grid">
                    <div class="modal-img">
                        <img id="printerImage" alt="Impressora" class="printer-image">
                    </div>
                    <div class="container-toner">
                        <h6><strong>Capacidade</strong></h6>
                        <div class="container-capacidade-modal">
                            <div>
                                <div class="ink-level-modal">
                                    <div id="black-ink-fill" class="ink-fill-modal" style="background-color: black;"></div>
                                </div>
                                <p style="font-weight: bold" id="black-percentage">100%</p>
                            </div>
                            <div>
                                <div class="ink-level-modal" id="cyan-ink-level-modal">
                                    <div id="cyan-ink-fill" class="ink-fill-modal" style="background-color: cyan;"></div>
                                </div>
                                <p style="font-weight: bold" id="cyan-percentage">100%</p>
                            </div>
                            <div>
                                <div class="ink-level-modal" id="yellow-ink-level-modal">
                                    <div id="yellow-ink-fill" class="ink-fill-modal" style="background-color: yellow;"></div>
                                </div>
                                <p style="font-weight: bold" id="yellow-percentage">100%</p>
                            </div>
                            <div>
                                <div class="ink-level-modal" id="magenta-ink-level-modal">
                                    <div id="magenta-ink-fill" class="ink-fill-modal" style="background-color: magenta;"></div>
                                </div>
                                <p style="font-weight: bold" id="magenta-percentage">100%</p>
                            </div>
                        </div>
                        <h6><strong>Modelo</strong></h6>
                        <p id="modalPrinterModel">X3B7001709</p>
                    </div>
                    <div class="modal-info">
                        <h6><strong>Patrimônio</strong></h6>
                        <p id="modalPatrimonio" style="padding-bottom:10px">83</p>
                        <h6><strong>Serial Uni. Imagem</strong></h6>
                        <p id="modalSerial" style="padding-bottom:10px">X3B7001709</p>
                        <h6><strong>Serial Tonner Preto</strong></h6>
                        <p id="modalSerialTonner" style="padding-bottom:10px">X3B7001709</p>
                        <h6><strong>Local</strong></h6>
                        <p id="modalSecretaria" style="padding-bottom: 10px; ">Insira secretaria...</p>
                    </div>
                    <div class="modal-impressions">
                        <h6><strong>Impressões Totais</strong></h6>
                        <p id="modalImpressaoTotal">Impressões</p>
                    </div>
                    <div class="container-toner">
                        <h6><strong>Fusor, Belt e Kit Manutenção</strong></h6>
                        <div class="container-capacidade-modal">
                            <div>
                                <div class="ink-level-modal">
                                    <div id="fusor-ink-fill" class="ink-fill-modal" style="height: 100%; background-color: gray;"></div>
                                </div>
                                <p style="font-weight: bold" id="fusor-percentage">100%</p>
                            </div>
                            <div>
                                <div class="ink-level-modal">
                                    <div id="belt-ink-fill" class="ink-fill-modal" style="height: 100%; background-color: gray;"></div>
                                </div>
                                <p style="font-weight: bold" id="belt-percentage">100%</p>
                            </div>
                            <div>
                                <div class="ink-level-modal">
                                    <div id="kit-ink-fill" class="ink-fill-modal" style="height: 100%; background-color: gray;"></div>
                                </div>
                                <p style="font-weight: bold" id="kit-percentage">100%</p>
                            </div>
                        </div>
                    </div> <div class="container-toner">
                        <h6><strong>Unidade de Imagem</strong></h6>
                        <div class="container-capacidade-modal">
                            <div>
                                <div class="ink-level-modal">
                                    <div id="u-ink-fill" class="ink-fill-modal" style="height: 100%; background-color: gray;"></div>
                                </div>
                                <p style="font-weight: bold" id="unidade-imagem-percentage"></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div >
        <div class="containerNumeroImpressoras">
            <div class="container mt-4">
                <div class="card shadow-sm border-light">
                    <div class="card-body">
                        <h5 class="card-title text-center">
                            Impressoras monitoradas
                        </h5>
                        <p class="text-center display-6 font-weight-bold text-primary">
                            @ViewBag.TotalImpressoras
                        </p>
                    </div>
                </div>
            </div>
        </div>
        

        <form method="get" action="/Home/Painel">
            <div class="filtrosImpressoras">
                <label>
                    <input type="checkbox" name="intervalo1" value="true"
                           @(Request.QueryString["intervalo1"] == "true" ? "checked" : "") />
                    <img src="~/Imagens/Icon.svg" class="feedback-nav" alt="feedback">
                    <p class="feedback-p">100% até 60%</p>
                </label>
                <label>
                    <input type="checkbox" name="intervalo2" value="true"
                           @(Request.QueryString["intervalo2"] == "true" ? "checked" : "") />
                    <img src="~/Imagens/IconYellow.svg" class="feedback-nav" alt="feedback">
                    <p class="feedback-p">60% até 20%</p>
                </label>
                <label>
                    <input type="checkbox" name="intervalo3" value="true"
                           @(Request.QueryString["intervalo3"] == "true" ? "checked" : "") />
                    <img src="~/Imagens/IconOrange.svg" class="feedback-nav" alt="feedback">
                    <p class="feedback-p">20% até 10%</p>
                </label>
                <label>
                    <input type="checkbox" name="intervalo4" value="true"
                           @(Request.QueryString["intervalo4"] == "true" ? "checked" : "") />
                    <img src="~/Imagens/IconRed.svg" class="feedback-nav" alt="feedback">
                    <p class="feedback-p">10% até 1%</p>
                </label>
                <label>
                    <input type="checkbox" name="esgotado" value="true"
                           @(Request.QueryString["esgotado"] == "true" ? "checked" : "") />
                    <img src="~/Imagens/IconBlack.svg" class="feedback-nav" alt="feedback">
                    <p class="feedback-p">Esgotado!</p>
                </label>
                <button type="submit" class="btn btn-primary ml-2">Aplicar Filtros</button>
                <button type="button" class="btn btn-danger" onclick="toggleNavbar()">Esconder menu</button>
                <button type="button" id="pauseButton" class="btn btn-primary ml-2">
                    <i id="pauseIcon" class="bi bi-pause-circle"></i>
                    <span id="pauseText">Pausar</span>
                </button>
            </div>
        </form>


        <div style=" display: flex; align-items: center; gap: .5rem; flex-wrap: nowrap; justify-content: center;">
            <button onclick="goToPrevious()" class="btn btn-primary">
                <i class="bi bi-arrow-left"></i>
            </button>
            <button onclick="goToNext()" class="btn btn-primary">
                <i class="bi bi-arrow-right"></i>
            </button>
        </div>

    </div>
    <p class="numeroImpressoras"><em>Impressoras monitoradas:</em> @ViewBag.TotalImpressoras</p>
</main>

<script>
    // Função para abrir as informaçõ de impressora com animação
    function abrirInfo(id) {
        var div_info = document.getElementById("info_impressora_" + id);
        var i_icon = document.getElementById("icon_" + id);

        div_info.classList.add('transition-info');

        if (div_info.style.display === "none" || !div_info.classList.contains('show')) {
            div_info.classList.add('show');
            div_info.style.display = "block";
            i_icon.style.transform = "rotate(180deg)";
        } else {
            div_info.classList.remove('show');
            i_icon.style.transform = "rotate(0deg)";
            setTimeout(function () {
                div_info.style.display = "none";
            }, 300); 
        }
    }


    // Função para definir o número de containers por página
    function setMaxContainersPerScreen() {
        const width = window.innerWidth;

        if (width >= 3840) {
            return 42;
        } else if (width >= 1440) {
            return 20;
        } else if (width >= 1080) {
            return 15;
        } else {
            return 15;
        }
    }

    // Função para verificar as porcentagens de tinta
    function verificarPorcentagens() {
        const linhas = document.querySelectorAll("#corpo_tabela tr[data-id]");

        linhas.forEach(linha => {
            linha.querySelectorAll('.ink-level').forEach(div => {
                const porcentagem = parseInt(div.querySelector('.ink-fill').style.height);

                if (porcentagem === 0) {
                    const icone = document.createElement('i');
                    icone.className = 'bi bi-exclamation-octagon';
                    icone.style.fontSize = '24px';
                    div.replaceWith(icone);
                }
            });
        });
    }

    // Variáveis de controle da rotação
    const containers = Array.from(document.querySelectorAll('.containerImpressora'));
    let currentPage = 0; // Agora usamos currentPage para controlar a navegação por páginas
    var maxContainersPerScreen = setMaxContainersPerScreen(); // Máximo de containers por tela
    const displayDuration = 30000; // Duração de cada exibição
    let intervalId;
    let isPaused = false;
    let isUserNavigating = false; // Controle da navegação manual

    // Calcular o número total de páginas e armazenar as páginas
    let pages = [];

    // Função para calcular e dividir os containers em páginas
    function calculatePages() {
        pages = []; // Limpa as páginas antigas

        for (let i = 0; i < containers.length; i += maxContainersPerScreen) {
            pages.push(containers.slice(i, i + maxContainersPerScreen));
        }
    }

    // Função para renderizar os containers para a página atual
    function renderContainers() {
        if (isPaused && !isUserNavigating) return; // Verifica se está pausado, mas permite navegação manual

        const gridContainer = document.querySelector('.gridContainer');
        gridContainer.innerHTML = ''; // Limpa os containers anteriores

        // Adiciona a classe `six-columns` ou `seven-columns` conforme o máximo de containers
        if (maxContainersPerScreen === 30) {
            gridContainer.classList.add('six-columns');
        } else {
            gridContainer.classList.remove('six-columns');
        }

        if (maxContainersPerScreen === 42) {
            gridContainer.classList.add('seven-columns');
        } else {
            gridContainer.classList.remove('seven-columns');
        }

        // Adiciona os containers da página atual
        const containersToShow = pages[currentPage];
        containersToShow.forEach(container => {
            gridContainer.appendChild(container);
        });
    }

    // Função para navegar para a página anterior ou próxima
    function changePage(direction) {
        console.log('Página antes:', currentPage);
        currentPage += direction;
        if (currentPage < 0) {
            currentPage = pages.length - 1;
        } else if (currentPage >= pages.length) {
            currentPage = 0;
        }
        console.log('Página depois:', currentPage);
        renderContainers();
    }


    // Função para iniciar a rotação
    function startRotation() {
        console.log('Iniciando rotação...');
        intervalId = setInterval(function () {
            if (!isPaused) {
                console.log('Mudando página');
                changePage(1); // Avança para a próxima página
            }
        }, displayDuration);
    }

    
    // Função para parar a rotação
    function stopRotation() {
        console.log('Parando rotação...');
        clearInterval(intervalId);
    }


    // Função para alternar entre pausar e retomar
    function togglePause() {
        isPaused = !isPaused;
        const pauseIcon = document.getElementById('pauseIcon');
        const pauseText = document.getElementById('pauseText');

        if (isPaused) {
            stopRotation();
            pauseIcon.className = 'bi bi-play-circle';
            pauseText.textContent = 'Retomar';
        } else {
            startRotation();
            pauseIcon.className = 'bi bi-pause-circle';
            pauseText.textContent = 'Pausar';
        }

        isUserNavigating = false; // Reseta a navegação manual após o toggle de pausa
    }

    // Inicia a rotação ao carregar a página
    verificarPorcentagens();
    calculatePages(); // Calcula as páginas no carregamento
    renderContainers();
    startRotation();

    // Configura o botão de pausa
    document.getElementById('pauseButton').addEventListener('click', togglePause);

    // Função para abrir o modal e mostrar as informações detalhadas da impressora
    function openModal(printerModel, patrimonio, deviceModel, impressaoTotal, black, cyan, yellow, magenta, fusor, belt, kit, secretaria, depto, unidade_imagem, impressora_tipo, serialTonner, deviceManufacturer) {

        function getIconPath(black) {
            if (black >= 60) {
                return "/Imagens/Icon.svg";
            } else if (black >= 20) {
                return "/Imagens/IconYellow.svg";
            } else if (black >= 1) {
                return "/Imagens/IconRed.svg";
            } else {
                return "/Imagens/IconBlack.svg";
            }
        }

        const icon = getIconPath(black);

        // Atualiza o conteúdo do modal
        const imgImpressoras = document.getElementById('printerImage');
        if (imgImpressoras) {
            imgImpressoras.src = `/Imagens/Impressoras/${deviceManufacturer}.png`;
        } else {
            console.error("Elemento 'printerImage' não encontrado.");
        }
        document.getElementById('modalPrinterModel').textContent = printerModel;
        document.getElementById('modalPatrimonio').textContent = patrimonio;
        document.getElementById('modalSerial').textContent = deviceModel;
        if (serialTonner != "") {
            document.getElementById('modalSerialTonner').textContent = serialTonner;
        }
        else {
            document.getElementById('modalSerialTonner').textContent = "Não Encontrado";
        }
        document.getElementById('modalImpressaoTotal').textContent = impressaoTotal + " Impressões";

        if (secretaria != "" && depto != "") {
            document.getElementById("modalSecretaria").textContent = secretaria + " - " + depto;
        }
        else {
            document.getElementById("modalSecretaria").textContent = "Não foi possível localizar a impressora";
        }
        document.getElementById("icon").src = icon;

        // Atualiza as porcentagens de tinta no modal
        document.getElementById("black-ink-fill").style.height = black + "%";
        document.getElementById("black-percentage").textContent = black + "%";

        // Verifica se a impressora é mono, se for, oculta ciano, magenta e amarelo
        if (impressora_tipo == "MONO") {
            document.getElementById("cyan-ink-fill").style.display = "none";
            document.getElementById("yellow-ink-fill").style.display = "none";
            document.getElementById("magenta-ink-fill").style.display = "none";
            document.getElementById("cyan-percentage").style.display = "none";
            document.getElementById("yellow-percentage").style.display = "none";
            document.getElementById("magenta-percentage").style.display = "none";
            document.getElementById("cyan-ink-level-modal").style.display = "none";
            document.getElementById("yellow-ink-level-modal").style.display = "none";
            document.getElementById("magenta-ink-level-modal").style.display = "none";
        } else {
            document.getElementById("cyan-ink-fill").style.height = cyan + "%";
            document.getElementById("yellow-ink-fill").style.height = yellow + "%";
            document.getElementById("magenta-ink-fill").style.height = magenta + "%";

            document.getElementById("cyan-percentage").textContent = cyan + "%";
            document.getElementById("yellow-percentage").textContent = yellow + "%";
            document.getElementById("magenta-percentage").textContent = magenta + "%";

            // Exibe ciano, magenta e amarelo se não for mono
            document.getElementById("cyan-ink-fill").style.display = "block";
            document.getElementById("yellow-ink-fill").style.display = "block";
            document.getElementById("magenta-ink-fill").style.display = "block";
            document.getElementById("cyan-percentage").style.display = "block";
            document.getElementById("yellow-percentage").style.display = "block";
            document.getElementById("magenta-percentage").style.display = "block";
        }

        // Atualiza os itens de manutenção
        document.getElementById("fusor-ink-fill").style.height = fusor + "%";
        document.getElementById("belt-ink-fill").style.height = belt + "%";
        document.getElementById("kit-ink-fill").style.height = kit + "%";
        document.getElementById("u-ink-fill").style.height = unidade_imagem + "%";

        document.getElementById("fusor-percentage").textContent = fusor + "%";
        document.getElementById("belt-percentage").textContent = belt + "%";
        document.getElementById("kit-percentage").textContent = kit + "%";
        document.getElementById("unidade-imagem-percentage").textContent = kit + "%";

        // Abre o modal
        $('#impressoraModal').modal('show');
    }

    // Função para atualizar o valor de maxContainersPerScreen
    function updateMaxContainers(event) {
        event.preventDefault(); // Previne o comportamento padrão do formulário
        const select = document.getElementById('maxContainersSelect');
        const newMax = parseInt(select.value);

        maxContainersPerScreen = newMax; // Atualiza a variável global
        currentPage = 0; // Reinicia o índice para começar do início
        calculatePages(); // Recalcula as páginas após alterar o valor
        renderContainers(); // Renderiza novamente com o novo valor
    }

    // Funções de navegação manual
    function goToNext() {
        isUserNavigating = true; // Usuário está navegando manualmente
        changePage(1); // Direção 1 para avançar
    }

    function goToPrevious() {
        isUserNavigating = true; // Usuário está navegando manualmente
        changePage(-1); // Direção -1 para retroceder
    }

</script>